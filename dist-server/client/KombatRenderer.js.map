{"version":3,"sources":["../../src/client/KombatRenderer.js"],"names":["ctx","canvas","game","C_WIDTH","C_HEIGHT","QPI","Math","PI","KombatRenderer","gameEngine","clientEngine","document","getElementById","getContext","shadowOffsetX","shadowOffsetY","shadowBlur","offset","TwoVector","playerKombat","x","scope","position","width","y","height","t","dt","clearRect","save","translate","world","queryObject","playerId","instanceType","Kombat","lineWidth","scale","setOffset","zoom","queryObjects","Blood","forEach","obj","drawBlood","Wall","drawWall","forEachObject","id","drawKombat","Bullet","drawBullet","Granade","drawGranade","Heal2","drawHeal","Explosion2","drawExplosion","drawDeadZone","drawHUD","restore","DeadZone","shadowColor","fillStyle","radius","center","beginPath","arc","rect","closePath","fill","fillRect","ammo_loaded","font","fillText","i","strokeStyle","j","granade_loaded","stroke","throw_power","health","max_health","player","debugContainer","innerHTML","mouseIsDown","edge","SQRT2","getCenter","getCircumscribedRadiusLength","color","drawCircle","name","length","moveTo","lineTo","cos","direction","sin","throwing_granade","a","b","drawBox","splatter","sp","r","w","h","Renderer"],"mappings":"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","sourcesContent":["import { Renderer, TwoVector } from 'lance-gg';\nimport Kombat from '../common/Kombat';\nimport Bullet from '../common/Bullet';\nimport Granade from '../common/Granade';\nimport Wall from '../common/Wall';\nimport Blood from '../common/Blood';\nimport Explosion2 from '../common/Explosion2';\nimport Heal2 from '../common/Heal2';\nimport DeadZone from '../common/DeadZone';\n\nlet ctx = null;\nlet canvas = null;\nlet game = null;\nconst C_WIDTH = 800;\nconst C_HEIGHT = 600;\nconst QPI = Math.PI/4\nexport default class KombatRenderer extends Renderer {\n\n    constructor(gameEngine, clientEngine) {\n        super(gameEngine, clientEngine);\n        game = gameEngine;\n        canvas = document.getElementById('kc');\n        ctx = canvas.getContext('2d');\n        \n        ctx.shadowOffsetX = 1;\n        ctx.shadowOffsetY = 1;\n        ctx.shadowBlur = 15; \n        this.offset = new TwoVector(0, 0);\n    }\n\n    setOffset(playerKombat){\n        this.offset.x = (C_WIDTH/2)/playerKombat.scope - playerKombat.position.x - (playerKombat.width / 2);\n        this.offset.y = (C_HEIGHT/2)/playerKombat.scope - playerKombat.position.y - (playerKombat.height / 2);\n    }\n\n    draw(t, dt) {\n    \n        super.draw(t, dt);\n        ctx.clearRect(0, 0, C_WIDTH, C_HEIGHT);\n        ctx.save();\n        ctx.translate(0, 0);\n        ctx.shadowBlur = 15; \n        //draw blood stains first // layer 0\n        let playerKombat = this.gameEngine.world.queryObject({ playerId: this.gameEngine.playerId,  instanceType: Kombat });\n        if(playerKombat){\n            ctx.lineWidth = 3 / playerKombat.scope;\n            ctx.scale(playerKombat.scope, playerKombat.scope);\n            this.setOffset(playerKombat);\n        }\n        else{\n            ctx.lineWidth = 3 / this.clientEngine.zoom;\n            ctx.scale(this.clientEngine.zoom, this.clientEngine.zoom);\n            this.offset.x = 0;\n            this.offset.y = 0;\n        } \n        game.world.queryObjects({instanceType: Blood }).forEach(obj => this.drawBlood(obj));\n        game.world.queryObjects({instanceType: Wall }).forEach(obj => this.drawWall(obj));\n        game.world.forEachObject((id, obj) => {\n            if (obj instanceof Kombat) this.drawKombat(obj);\n            else if (obj instanceof Bullet) this.drawBullet(obj);\n            else if (obj instanceof Granade) this.drawGranade(obj);\n            else if (obj instanceof Heal2) this.drawHeal(obj);\n        });\n\n        game.world.queryObjects({instanceType: Explosion2 }).forEach(obj => this.drawExplosion(obj));\n        this.drawDeadZone();\n\n        if(playerKombat){\n            this.drawHUD(playerKombat);\n        }\n     \n        ctx.restore();\n    }\n\n\n    drawDeadZone(){\n        let obj = this.gameEngine.world.queryObject({ instanceType: DeadZone });\n            if(obj){\n                ctx.shadowColor = \"rgba(100,0,200,.2)\";\n                ctx.fillStyle = \"rgba(100,0,255,.4)\";\n                if(obj.radius > 0){\n                let center = new TwoVector(\n                    obj.position.x + this.offset.x,\n                    obj.position.y + this.offset.y\n                );\n                ctx.beginPath();\n                ctx.arc(center.x, center.y, obj.radius, 0, 2 * Math.PI);\n                ctx.rect(\n                    800/this.clientEngine.zoom, \n                    0, \n                    -800/this.clientEngine.zoom, \n                    600/this.clientEngine.zoom\n                );\n                ctx.closePath();\n                ctx.fill();\n            }\n            else{\n                ctx.fillRect(0,0, 800/this.clientEngine.zoom, 600/this.clientEngine.zoom);\n            }\n        }\n    }\n\n    drawHUD(obj){\n        //Bullets and reloading\n            \n        ctx.scale(1, 1);\n        if(obj.ammo_loaded === -1){\n            ctx.fillStyle = \"white\";\n            ctx.font = \"1.8px 'Share Tech'\";\n            ctx.fillText(\"RELOADING . . .\", 125, 564/obj.scope);\n        }\n        else{\n            ctx.shadowColor = 'white';\n            ctx.fillStyle = \"orange\";\n            for(let i=0; i < obj.ammo_loaded; i++){\n                ctx.fillRect(\n                    (125 + i*6)/ obj.scope, \n                    543/ obj.scope, \n                    2 / obj.scope, \n                    2 / obj.scope\n                );\n                ctx.fillRect(\n                    (124 + i*6)/ obj.scope, \n                    545 / obj.scope, \n                    4 / obj.scope, \n                    20 / obj.scope\n                );\n            }\n        }\n        \n\n        //Granades\n        ctx.strokeStyle = \"#ADFEAE\";\n        for(let j=0; j<obj.granade_loaded; j++){\n            ctx.beginPath();\n            ctx.arc( (25 + j*12) / obj.scope,  535/ obj.scope, 5/obj.scope, 0, 2*Math.PI);\n            ctx.closePath();\n            ctx.stroke();\n        }\n\n        //Throw Power\n        ctx.strokeStyle = \"white\";\n        ctx.fillStyle = \"rgba(255, 255, 255, .9)\";\n        ctx.fillRect(\n            20/ obj.scope, \n            544/ obj.scope, \n            obj.throw_power  * 100 / obj.scope, \n            18 / obj.scope\n        );\n        ctx.beginPath();\n        ctx.rect(\n            20/ obj.scope, \n            545/ obj.scope, \n            100 / obj.scope, \n            18/ obj.scope\n        );\n        ctx.closePath();\n        ctx.stroke();\n        //Life\n        ctx.strokeStyle = \"white\";\n        ctx.fillStyle = \"rgba(255, 0, 0, .5)\";\n        ctx.fillRect(20/ obj.scope, 570/ obj.scope, obj.health * ( 760 / obj.max_health)/ obj.scope, 18/ obj.scope);\n        ctx.beginPath();\n        ctx.rect(20/ obj.scope, 570/ obj.scope, 760 / obj.scope, 16/ obj.scope);\n        ctx.closePath();\n        ctx.stroke();\n    }\n\n    updateDebugger(player, t, dt){\n        let debugContainer = document.getElementById('debug');\n        debugContainer.innerHTML = `\n            Pos X: ${player.position.x}\n            <hr/> \n            Pos Y: ${player.position.y}\n            <hr/>\n            Is shooting: ${this.mouseIsDown ? \"true\" : \"false\"}\n            <hr/>\n            Ammo: ${player.ammo_loaded}\n            <hr/>\n            Is reloading: ${player.ammo_loaded === -1 ? \"true\" : \"false\"}\n            <hr/>\n            t: ${t}\n            <hr/>\n            dt: ${dt}\n        `\n    }\n    getCenter(obj){\n        return new TwoVector(\n            obj.position.x + this.offset.x + obj.width/2,\n            obj.position.y + this.offset.y + obj.height/2\n        )\n    }\n    \n    getCircumscribedRadiusLength(edge){\n        return (edge * Math.SQRT2) / 2;\n    }\n\n    drawKombat(obj) {\n        \n        let center = this.getCenter(obj);\n        let radius = this.getCircumscribedRadiusLength(obj.width);\n        let color = obj.playerId === this.gameEngine.playerId ? \"dodgerblue\" : \"crimson\";\n        ctx.shadowColor = color;\n        ctx.strokeStyle = color;\n        //base circle\n        this.drawCircle(center.x, center.y, radius);\n        //kombat name\n   \n        ctx.fillStyle = \"white\";\n        ctx.font = '1px Arial';\n        ctx.fillText(obj.name, center.x - (obj.name.length/4), center.y - 2);\n\n        \n        //directional line\n        ctx.moveTo(center.x,center.y);\n        ctx.lineTo(center.x + radius * Math.cos(obj.direction), center.y + radius * Math.sin(obj.direction));\n        ctx.stroke();\n\n        //ammo reloading circle\n        if(obj.ammo_loaded === -1){\n            ctx.beginPath();\n            ctx.arc(center.x, center.y, radius+ radius/2, .1, QPI - .1);\n            ctx.stroke();\n            ctx.beginPath();\n            ctx.arc(center.x, center.y, radius+ radius/2, 2*QPI + .1, 3*QPI - .1);\n            ctx.stroke();\n            ctx.beginPath();\n            ctx.arc(center.x, center.y, radius+ radius/2, 4*QPI + .1, 5*QPI - .1);\n            ctx.stroke();\n            ctx.beginPath();\n            ctx.arc(center.x, center.y, radius+ radius/2, 6*QPI + .1, 7*QPI - .1);\n            ctx.stroke();\n        }\n\n        if(obj.throwing_granade === 1){\n            ctx.strokeStyle = \"white\";\n            ctx.shadowColor = \"white\";\n            ctx.beginPath();\n            ctx.arc(center.x, center.y, radius+ radius/2, QPI+.1, 2*QPI - .1);\n            ctx.stroke();\n            ctx.beginPath();\n            ctx.arc(center.x, center.y, radius+ radius/2, 3*QPI + .1, 4*QPI - .1);\n            ctx.stroke();\n            ctx.beginPath();\n            ctx.arc(center.x, center.y, radius+ radius/2, 5*QPI + .1, 6*QPI - .1);\n            ctx.stroke();\n            ctx.beginPath();\n            ctx.arc(center.x, center.y, radius+ radius/2, 7*QPI + .1, 8*QPI - .1);\n            ctx.stroke();\n        }\n    }\n\n    drawBullet(obj){\n        ctx.shadowColor = \"yellow\";\n        ctx.strokeStyle = \"yellow\";\n        let center = this.getCenter(obj);\n        ctx.beginPath();\n        ctx.arc(center.x, center.y, .5, 0, 2*Math.PI);\n        ctx.stroke();\n        ctx.closePath();\n    }\n\n    drawGranade(obj){\n        ctx.shadowColor = \"lime\";\n        ctx.strokeStyle = \"lime\";\n        let center = this.getCenter(obj);\n        ctx.beginPath();\n        ctx.arc(center.x, center.y, .8, 0, 2*Math.PI);\n        ctx.stroke();\n        ctx.closePath();\n    }\n\n    drawHeal(obj){\n        ctx.strokeStyle = \"white\";\n        ctx.shadowColor = \"white\";\n        let center = this.getCenter(obj);\n        let a =  .75;\n        let b = .2\n        ctx.beginPath();\n        ctx.arc(center.x, center.y, 1.2, 0, 2*Math.PI);\n        ctx.closePath();\n        ctx.stroke();\n        // ctx.beginPath();\n        // ctx.rect(center.x - a, center.y - b, 2*a, .2*b);\n        // ctx.closePath();\n        // ctx.stroke();\n        // ctx.beginPath();\n        // ctx.rect(center.x - b, center.y - a, 2*b, 2*a);\n        // ctx.closePath();\n        // ctx.stroke();\n\n        ctx.fillStyle = \"red\";\n        ctx.shadowColor = \"red\";\n        ctx.fillRect(center.x - a, center.y - b, 2*a, 2*b);\n        ctx.fillRect(center.x - b, center.y - a, 2*b, 2*a);\n      \n    }\n\n    drawWall(obj){\n        ctx.strokeStyle =  \"white\";\n        ctx.shadowColor = \"white\";\n        let center = this.getCenter(obj);\n        this.drawBox(center.x, center.y, obj.width, obj.height);\n    }\n\n    drawBlood(obj){\n        ctx.fillStyle = \"rgba(200,100,0,.4)\"\n        ctx.shadowColor = \"red\";\n        let center = this.getCenter(obj);\n        obj.splatter.forEach(sp => {\n            ctx.beginPath();\n            ctx.arc(center.x+1+sp[0], center.y+1+sp[1], sp[2], 0, 2*Math.PI);\n            ctx.closePath();\n            ctx.fill();\n        });\n    }\n\n    drawExplosion(obj) {\n        ctx.fillStyle = \"rgba(200, 200, 10, .4)\";\n        ctx.shadowColor = \"rgba(200, 200, 10, .4)\";;\n        let center = new TwoVector(\n            obj.position.x + this.offset.x,\n            obj.position.y + this.offset.y\n        );\n        ctx.beginPath();\n        ctx.arc(center.x, center.y, obj.radius, 0, 2*Math.PI);\n        ctx.closePath();\n        ctx.fill();\n    }\n\n    drawCircle(x, y, r, ) {\n        ctx.beginPath();\n        ctx.arc(x, y, r, 0, 2*Math.PI);\n        ctx.closePath();\n        ctx.stroke();\n    }\n\n    drawBox(x, y, w, h){\n        ctx.beginPath();\n        ctx.rect(x - (w/2), y - (h/2), w, h);\n        ctx.closePath();\n        ctx.stroke();\n    }\n}\n"],"file":"KombatRenderer.js"}