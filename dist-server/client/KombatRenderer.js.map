{"version":3,"sources":["../../src/client/KombatRenderer.js"],"names":["ctx","canvas","game","c","C_WIDTH","C_HEIGHT","KombatRenderer","gameEngine","clientEngine","document","createElement","width","height","body","insertBefore","getElementById","w","h","zoom","getContext","lineWidth","strokeStyle","fildlStyle","viewPort","TwoVector","t","dt","clearRect","save","fillRect","translate","scale","drawBounds","playerKombat","world","queryObject","playerId","instanceType","Kombat","offsetX","position","x","offsetY","y","forEachObject","id","obj","drawKombat","Bullet","drawBullet","Box","drawBox","restore","drawCircumscribedCircle","r","beginPath","arc","Math","PI","stroke","closePath","l","SQRT2","rect","strokeRect","Renderer"],"mappings":"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","sourcesContent":["import { Renderer, TwoVector } from 'lance-gg';\r\nimport Kombat from '../common/Kombat';\r\nimport Bullet from '../common/Bullet';\r\nimport Box from '../common/Box';\r\n\r\nlet ctx = null;\r\nlet canvas = null;\r\nlet game = null;\r\nlet c = 0;\r\nconst C_WIDTH = 800;\r\nconst C_HEIGHT = 600;\r\n\r\nexport default class KombatRenderer extends Renderer {\r\n\r\n    constructor(gameEngine, clientEngine) {\r\n        super(gameEngine, clientEngine);\r\n        game = gameEngine;\r\n        canvas = document.createElement('canvas');\r\n        \r\n        canvas.width = C_WIDTH;\r\n        canvas.height = C_HEIGHT;\r\n        document.body.insertBefore(canvas, document.getElementById('logo'));\r\n        game.w = canvas.width;\r\n        game.h = canvas.height;\r\n        clientEngine.zoom = 15;\r\n        \r\n        // if (game.w / game.spaceWidth < clientEngine.zoom) clientEngine.zoom = game.w / game.spaceWidth;\r\n        ctx = canvas.getContext('2d');\r\n        ctx.lineWidth = 2 / clientEngine.zoom;\r\n        ctx.strokeStyle = 'white';\r\n        ctx.fildlStyle= \"red\";\r\n        this.viewPort = new TwoVector(0, 0);\r\n    }\r\n\r\n    draw(t, dt) {\r\n        super.draw(t, dt);\r\n        ctx.clearRect(0, 0, game.w, game.h);\r\n        ctx.save();\r\n        ctx.fillRect(0, 0, 800, 600 );\r\n        ctx.translate(0, 0);\r\n        ctx.scale(this.clientEngine.zoom, this.clientEngine.zoom);  // Zoom in and flip y axis\r\n        this.drawBounds();\r\n        let playerKombat = this.gameEngine.world.queryObject({ playerId: this.gameEngine.playerId,  instanceType: Kombat });\r\n        if(playerKombat){\r\n            this.offsetX = (C_WIDTH/2)/this.clientEngine.zoom - playerKombat.position.x - (playerKombat.width / 2);\r\n            this.offsetY = (C_HEIGHT/2)/this.clientEngine.zoom - playerKombat.position.y - (playerKombat.height / 2);\r\n        }\r\n        game.world.forEachObject((id, obj) => {\r\n            if (obj instanceof Kombat) this.drawKombat(obj);\r\n            else if (obj instanceof Bullet) this.drawBullet(obj);\r\n            else if (obj instanceof Box) this.drawBox(obj.position.x, obj.position.y, obj.width, obj.height);\r\n        });\r\n        // ctx.translate(game.w/2 - 2, game.h/2 - 2);\r\n        \r\n        ctx.restore();\r\n    }\r\n\r\n    drawKombat(obj) {\r\n        this.drawCircumscribedCircle(obj.position.x + this.offsetX, obj.position.y + this.offsetY, obj.width);\r\n        this.drawBox(obj.position.x + this.offsetX, obj.position.y + this.offsetY, obj.width, obj.height);\r\n    }\r\n    drawBullet(obj){\r\n        this.drawCircumscribedCircle(obj.position.x + this.offsetX, obj.position.y + this.offsetY, obj.width);\r\n        this.drawBox(obj.position.x + this.offsetX, obj.position.y + this.offsetY, obj.width, obj.height);\r\n    }\r\n    drawCircle(x, y, r) {\r\n        ctx.beginPath();\r\n        ctx.arc(x+r, y+r, r, 0, 2*Math.PI);\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n    }\r\n    drawCircumscribedCircle(x, y, l){\r\n        ctx.beginPath();\r\n        ctx.arc(x+(l/2), y+(l/2), (l * Math.SQRT2) /2, 0, 2*Math.PI);\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n    }\r\n    drawBox(x, y, w, h){\r\n        ctx.beginPath();\r\n        ctx.rect(x, y, w, h);\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n    }\r\n    drawBounds() {\r\n        ctx.strokeRect(0 + this.offsetX, 0 + this.offsetY,30,12);\r\n    }\r\n}\r\n"],"file":"KombatRenderer.js"}