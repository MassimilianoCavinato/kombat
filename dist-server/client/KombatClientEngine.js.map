{"version":3,"sources":["../../src/client/KombatClientEngine.js"],"names":["KombatClientEngine","gameEngine","options","KombatRenderer","controls","KeyboardControls","bindKey","repeat","mouseIsDown","document","querySelector","addEventListener","window","location","reload","on","obj","playerId","type","style","display","mouseX","mouseY","updateMouseXY","bind","preStep","e","preventDefault","pageX","pageY","debugContainer","getElementById","player","world","queryObject","innerHTML","angle","Math","atan2","sendInput","movement","position","x","y","ClientEngine"],"mappings":"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","sourcesContent":["import { ClientEngine, KeyboardControls } from 'lance-gg';\nimport KombatRenderer from '../client/KombatRenderer';\n\nexport default class KombatClientEngine extends ClientEngine {\n\n    constructor(gameEngine, options) {\n\n        super(gameEngine, options, KombatRenderer);\n        this.controls = new KeyboardControls(this);\n        this.controls.bindKey('w', 'up', { repeat: true } );\n        this.controls.bindKey('s', 'down', { repeat: true } );\n        this.controls.bindKey('a', 'left', { repeat: true } );\n        this.controls.bindKey('d', 'right', { repeat: true } );\n        this.mouseIsDown = false;\n        // restart game\n        document.querySelector('#try-again').addEventListener('click', () => {\n            window.location.reload();\n        });\n        // show try-again button\n        gameEngine.on('objectDestroyed', (obj) => {\n            if (obj.playerId === gameEngine.playerId && obj.type === \"Kombat\") {\n                document.querySelector('#try-again').style.display = \"block\";\n            }\n        });\n\n        this.mouseX = null;\n        this.mouseY = null;\n        document.addEventListener('mouseenter', this.updateMouseXY.bind(this), false);\n        document.addEventListener('mousemove', this.updateMouseXY.bind(this), false);\n        document.addEventListener('mousedown', () => this.mouseIsDown = true );\n        document.addEventListener('mouseup', () => this.mouseIsDown = false);\n        this.gameEngine.on('client__preStep', this.preStep.bind(this));\n    }\n\n    updateMouseXY(e) {\n        e.preventDefault();\n        this.mouseX = e.pageX - 400;\n        this.mouseY = e.pageY - 300;\n    }\n    \n    preStep() {\n        let debugContainer = document.getElementById('debug');\n        let player = this.gameEngine.world.queryObject({ playerId: this.gameEngine.playerId });\n        if(player === null){\n            debugContainer.innerHTML = ``;\n        }\n        else{\n            if (this.mouseY){\n                let angle = Math.atan2(this.mouseY, this.mouseX);\n                this.sendInput(angle, { movement: true });\n                if(this.mouseIsDown === true){\n                    this.sendInput(\"shoot\", { repeat: true });\n                }\n\n                debugContainer.innerHTML = `\n                PlayerPos:\n                <br/> \n                X: ${player.position.x}\n                <br/> \n                Y: ${player.position.y}\n                <br/>\n                ----------------------------\n                <br/>\n                MousePos: \n                <br/> \n                X: ${this.mouseX}\n                <br/> \n                Y: ${this.mouseY}\n                <br/> \n                ----------------------------\n                <br/>\n                Angle: ${angle}\n                <br/>\n                ----------------------------\n                <br/>\n                IsShooting: ${this.mouseIsDown ? \"true\" : \"false\"}\n                <br/>\n                ----------------------------\n            `\n            }\n           \n        }\n    }\n}\n"],"file":"KombatClientEngine.js"}