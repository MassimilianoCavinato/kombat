{"version":3,"sources":["../../src/client/KombatClientEngine.js"],"names":["KombatClientEngine","gameEngine","options","KombatRenderer","controls","KeyboardControls","bindKey","repeat","document","querySelector","addEventListener","window","location","reload","on","obj","playerId","type","style","display","mouseX","mouseY","updateMouseXY","bind","e","shoot","preStep","preventDefault","pageX","pageY","debugContainer","getElementById","player","world","queryObject","innerHTML","angle","Math","atan2","sendInput","movement","position","x","y","ClientEngine"],"mappings":";;;;;;;AAAA;;AACA;;;;;;;;;;;;;;;;;;;;;;IAEqBA,kB;;;;;AAEjB,8BAAYC,UAAZ,EAAwBC,OAAxB,EAAiC;AAAA;;AAAA;;AAE7B,4FAAMD,UAAN,EAAkBC,OAAlB,EAA2BC,uBAA3B;AACA,UAAKC,QAAL,GAAgB,IAAIC,yBAAJ,+BAAhB;;AACA,UAAKD,QAAL,CAAcE,OAAd,CAAsB,GAAtB,EAA2B,IAA3B,EAAiC;AAAEC,MAAAA,MAAM,EAAE;AAAV,KAAjC;;AACA,UAAKH,QAAL,CAAcE,OAAd,CAAsB,GAAtB,EAA2B,MAA3B,EAAmC;AAAEC,MAAAA,MAAM,EAAE;AAAV,KAAnC;;AACA,UAAKH,QAAL,CAAcE,OAAd,CAAsB,GAAtB,EAA2B,MAA3B,EAAmC;AAAEC,MAAAA,MAAM,EAAE;AAAV,KAAnC;;AACA,UAAKH,QAAL,CAAcE,OAAd,CAAsB,GAAtB,EAA2B,OAA3B,EAAoC;AAAEC,MAAAA,MAAM,EAAE;AAAV,KAApC,EAP6B,CAQ7B;;;AACAC,IAAAA,QAAQ,CAACC,aAAT,CAAuB,YAAvB,EAAqCC,gBAArC,CAAsD,OAAtD,EAA+D,YAAM;AACjEC,MAAAA,MAAM,CAACC,QAAP,CAAgBC,MAAhB;AACH,KAFD,EAT6B,CAY7B;;AACAZ,IAAAA,UAAU,CAACa,EAAX,CAAc,iBAAd,EAAiC,UAACC,GAAD,EAAS;AACtC,UAAIA,GAAG,CAACC,QAAJ,KAAiBf,UAAU,CAACe,QAA5B,IAAwCD,GAAG,CAACE,IAAJ,KAAa,QAAzD,EAAmE;AAC/DT,QAAAA,QAAQ,CAACC,aAAT,CAAuB,YAAvB,EAAqCS,KAArC,CAA2CC,OAA3C,GAAqD,OAArD;AACH;AACJ,KAJD;AAMA,UAAKC,MAAL,GAAc,IAAd;AACA,UAAKC,MAAL,GAAc,IAAd;AACAb,IAAAA,QAAQ,CAACE,gBAAT,CAA0B,WAA1B,EAAuC,MAAKY,aAAL,CAAmBC,IAAnB,+BAAvC,EAAsE,KAAtE;AACAf,IAAAA,QAAQ,CAACE,gBAAT,CAA0B,YAA1B,EAAwC,MAAKY,aAAL,CAAmBC,IAAnB,+BAAxC,EAAuE,KAAvE;AACAf,IAAAA,QAAQ,CAACE,gBAAT,CAA0B,WAA1B,EAAuC,UAACc,CAAD;AAAA,aAAO,MAAKC,KAAL,CAAWD,CAAX,CAAP;AAAA,KAAvC;;AACA,UAAKvB,UAAL,CAAgBa,EAAhB,CAAmB,iBAAnB,EAAsC,MAAKY,OAAL,CAAaH,IAAb,+BAAtC;;AAxB6B;AAyBhC;;;;kCAEaC,C,EAAG;AACbA,MAAAA,CAAC,CAACG,cAAF;AACA,WAAKP,MAAL,GAAcI,CAAC,CAACI,KAAF,GAAU,GAAxB;AACA,WAAKP,MAAL,GAAcG,CAAC,CAACK,KAAF,GAAU,GAAxB;AACH;;;8BAES;AACN,UAAIC,cAAc,GAAGtB,QAAQ,CAACuB,cAAT,CAAwB,OAAxB,CAArB;AACA,UAAIC,MAAM,GAAG,KAAK/B,UAAL,CAAgBgC,KAAhB,CAAsBC,WAAtB,CAAkC;AAAElB,QAAAA,QAAQ,EAAE,KAAKf,UAAL,CAAgBe;AAA5B,OAAlC,CAAb;;AACA,UAAGgB,MAAM,KAAK,IAAd,EAAmB;AACfF,QAAAA,cAAc,CAACK,SAAf;AACH,OAFD,MAGI;AACA,YAAI,KAAKd,MAAT,EAAgB;AACZ,cAAIe,KAAK,GAAGC,IAAI,CAACC,KAAL,CAAW,KAAKjB,MAAhB,EAAwB,KAAKD,MAA7B,CAAZ;AACA,eAAKmB,SAAL,CAAeH,KAAf,EAAsB;AAAEI,YAAAA,QAAQ,EAAE;AAAZ,WAAtB;AACAV,UAAAA,cAAc,CAACK,SAAf,sFAGKH,MAAM,CAACS,QAAP,CAAgBC,CAHrB,0DAKKV,MAAM,CAACS,QAAP,CAAgBE,CALrB,kLAWK,KAAKvB,MAXV,0DAaK,KAAKC,MAbV,mIAiBSe,KAjBT;AAqBH;AAEJ;AACJ;;;4BAGM;AACH,WAAKG,SAAL,CAAe,OAAf,EAAwB;AAAEC,QAAAA,QAAQ,EAAE;AAAZ,OAAxB;AACH;;;;EA1E2CI,qB","sourcesContent":["import { ClientEngine, KeyboardControls } from 'lance-gg';\r\nimport KombatRenderer from '../client/KombatRenderer';\r\n\r\nexport default class KombatClientEngine extends ClientEngine {\r\n\r\n    constructor(gameEngine, options) {\r\n\r\n        super(gameEngine, options, KombatRenderer);\r\n        this.controls = new KeyboardControls(this);\r\n        this.controls.bindKey('w', 'up', { repeat: true } );\r\n        this.controls.bindKey('s', 'down', { repeat: true } );\r\n        this.controls.bindKey('a', 'left', { repeat: true } );\r\n        this.controls.bindKey('d', 'right', { repeat: true } );\r\n        // restart game\r\n        document.querySelector('#try-again').addEventListener('click', () => {\r\n            window.location.reload();\r\n        });\r\n        // show try-again button\r\n        gameEngine.on('objectDestroyed', (obj) => {\r\n            if (obj.playerId === gameEngine.playerId && obj.type === \"Kombat\") {\r\n                document.querySelector('#try-again').style.display = \"block\";\r\n            }\r\n        });\r\n\r\n        this.mouseX = null;\r\n        this.mouseY = null;\r\n        document.addEventListener('mousemove', this.updateMouseXY.bind(this), false);\r\n        document.addEventListener('mouseenter', this.updateMouseXY.bind(this), false);\r\n        document.addEventListener('mousedown', (e) => this.shoot(e));\r\n        this.gameEngine.on('client__preStep', this.preStep.bind(this));\r\n    }\r\n\r\n    updateMouseXY(e) {\r\n        e.preventDefault();\r\n        this.mouseX = e.pageX - 400;\r\n        this.mouseY = e.pageY - 300;\r\n    }\r\n    \r\n    preStep() {\r\n        let debugContainer = document.getElementById('debug');\r\n        let player = this.gameEngine.world.queryObject({ playerId: this.gameEngine.playerId });\r\n        if(player === null){\r\n            debugContainer.innerHTML = ``;\r\n        }\r\n        else{\r\n            if (this.mouseY){\r\n                let angle = Math.atan2(this.mouseY, this.mouseX);\r\n                this.sendInput(angle, { movement: true });\r\n                debugContainer.innerHTML = `\r\n                PlayerPos:\r\n                <br/> \r\n                X: ${player.position.x}\r\n                <br/> \r\n                Y: ${player.position.y}\r\n                <br/>\r\n                ----------------------------\r\n                <br/>\r\n                MousePos: \r\n                <br/> \r\n                X: ${this.mouseX}\r\n                <br/> \r\n                Y: ${this.mouseY}\r\n                <br/> \r\n                ----------------------------\r\n                <br/>\r\n                Angle: ${angle}\r\n                <br/>\r\n                ----------------------------\r\n            `\r\n            }\r\n           \r\n        }\r\n    }\r\n\r\n    \r\n    shoot(){\r\n        this.sendInput(\"shoot\", { movement: true });\r\n    }\r\n}\r\n"],"file":"KombatClientEngine.js"}