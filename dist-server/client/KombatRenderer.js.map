{"version":3,"sources":["../../src/client/KombatRenderer.js"],"names":["ctx","canvas","game","C_WIDTH","C_HEIGHT","QPI","Math","PI","KombatRenderer","gameEngine","clientEngine","document","createElement","setAttribute","width","height","body","appendChild","zoom","getContext","lineWidth","shadowOffsetX","shadowOffsetY","shadowBlur","offset","TwoVector","playerKombat","x","position","y","t","dt","clearRect","save","translate","scale","world","queryObject","playerId","instanceType","Kombat","setOffset","queryObjects","Blood","forEach","obj","drawBlood","Wall","drawWall","forEachObject","id","drawKombat","Bullet","drawBullet","Granade","drawGranade","Explosion2","drawExplosion","drawDeadZone","drawHUD","updateDebugger","restore","DeadZone","radius","center","shadowColor","fillStyle","beginPath","arc","rect","closePath","fill","i","ammo_loaded","fillRect","strokeStyle","throw_power","stroke","health","max_health","player","debugContainer","getElementById","innerHTML","angle","mouseIsDown","edge","SQRT2","getCenter","getCircumscribedRadiusLength","color","drawCircle","font","fillText","name","length","moveTo","lineTo","cos","direction","sin","throwing_granade","drawBox","splatter","sp","r","w","h","Renderer"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA,IAAIA,GAAG,GAAG,IAAV;AACA,IAAIC,MAAM,GAAG,IAAb;AACA,IAAIC,IAAI,GAAG,IAAX;AACA,IAAMC,OAAO,GAAG,GAAhB;AACA,IAAMC,QAAQ,GAAG,GAAjB;AACA,IAAMC,GAAG,GAAGC,IAAI,CAACC,EAAL,GAAQ,CAApB;;IACqBC,c;;;;;AAEjB,0BAAYC,UAAZ,EAAwBC,YAAxB,EAAsC;AAAA;;AAAA;;AAClC,wFAAMD,UAAN,EAAkBC,YAAlB;AACAR,IAAAA,IAAI,GAAGO,UAAP;AACAR,IAAAA,MAAM,GAAGU,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAT;AACAX,IAAAA,MAAM,CAACY,YAAP,CAAoB,IAApB,EAA0B,IAA1B;AACAZ,IAAAA,MAAM,CAACa,KAAP,GAAeX,OAAf;AACAF,IAAAA,MAAM,CAACc,MAAP,GAAgBX,QAAhB;AACAO,IAAAA,QAAQ,CAACK,IAAT,CAAcC,WAAd,CAA0BhB,MAA1B;AACAS,IAAAA,YAAY,CAACQ,IAAb,GAAoB,EAApB;AACAlB,IAAAA,GAAG,GAAGC,MAAM,CAACkB,UAAP,CAAkB,IAAlB,CAAN;AACAnB,IAAAA,GAAG,CAACoB,SAAJ,GAAgB,IAAIV,YAAY,CAACQ,IAAjC;AACAlB,IAAAA,GAAG,CAACqB,aAAJ,GAAoB,CAApB;AACArB,IAAAA,GAAG,CAACsB,aAAJ,GAAoB,CAApB;AACAtB,IAAAA,GAAG,CAACuB,UAAJ,GAAiB,EAAjB;AACA,UAAKC,MAAL,GAAc,IAAIC,kBAAJ,CAAc,CAAd,EAAiB,CAAjB,CAAd;AAdkC;AAerC;;;;8BAESC,Y,EAAa;AACnB,WAAKF,MAAL,CAAYG,CAAZ,GAAiBxB,OAAO,GAAC,CAAT,GAAY,KAAKO,YAAL,CAAkBQ,IAA9B,GAAqCQ,YAAY,CAACE,QAAb,CAAsBD,CAA3D,GAAgED,YAAY,CAACZ,KAAb,GAAqB,CAArG;AACA,WAAKU,MAAL,CAAYK,CAAZ,GAAiBzB,QAAQ,GAAC,CAAV,GAAa,KAAKM,YAAL,CAAkBQ,IAA/B,GAAsCQ,YAAY,CAACE,QAAb,CAAsBC,CAA5D,GAAiEH,YAAY,CAACX,MAAb,GAAsB,CAAvG;AACH;;;yBAEIe,C,EAAGC,E,EAAI;AAAA;;AACR,+EAAWD,CAAX,EAAcC,EAAd;;AACA/B,MAAAA,GAAG,CAACgC,SAAJ,CAAc,CAAd,EAAiB,CAAjB,EAAoB7B,OAApB,EAA6BC,QAA7B;AACAJ,MAAAA,GAAG,CAACiC,IAAJ;AACAjC,MAAAA,GAAG,CAACkC,SAAJ,CAAc,CAAd,EAAiB,CAAjB;AACAlC,MAAAA,GAAG,CAACmC,KAAJ,CAAU,KAAKzB,YAAL,CAAkBQ,IAA5B,EAAkC,KAAKR,YAAL,CAAkBQ,IAApD;AACAlB,MAAAA,GAAG,CAACoB,SAAJ,GAAgB,IAAI,KAAKV,YAAL,CAAkBQ,IAAtC;AACA,UAAIQ,YAAY,GAAG,KAAKjB,UAAL,CAAgB2B,KAAhB,CAAsBC,WAAtB,CAAkC;AAAEC,QAAAA,QAAQ,EAAE,KAAK7B,UAAL,CAAgB6B,QAA5B;AAAuCC,QAAAA,YAAY,EAAEC;AAArD,OAAlC,CAAnB;;AACA,UAAGd,YAAH,EAAgB;AACZ,aAAKe,SAAL,CAAef,YAAf,EADY,CAEZ;;AACAxB,QAAAA,IAAI,CAACkC,KAAL,CAAWM,YAAX,CAAwB;AAACH,UAAAA,YAAY,EAAEI;AAAf,SAAxB,EAAgDC,OAAhD,CAAwD,UAAAC,GAAG;AAAA,iBAAI,MAAI,CAACC,SAAL,CAAeD,GAAf,CAAJ;AAAA,SAA3D;AACA3C,QAAAA,IAAI,CAACkC,KAAL,CAAWM,YAAX,CAAwB;AAACH,UAAAA,YAAY,EAAEQ;AAAf,SAAxB,EAA+CH,OAA/C,CAAuD,UAAAC,GAAG;AAAA,iBAAI,MAAI,CAACG,QAAL,CAAcH,GAAd,CAAJ;AAAA,SAA1D;AACA3C,QAAAA,IAAI,CAACkC,KAAL,CAAWa,aAAX,CAAyB,UAACC,EAAD,EAAKL,GAAL,EAAa;AAClC,cAAIA,GAAG,YAAYL,eAAnB,EAA2B,MAAI,CAACW,UAAL,CAAgBN,GAAhB,EAA3B,KACK,IAAIA,GAAG,YAAYO,eAAnB,EAA2B,MAAI,CAACC,UAAL,CAAgBR,GAAhB,EAA3B,KACA,IAAIA,GAAG,YAAYS,gBAAnB,EAA4B,MAAI,CAACC,WAAL,CAAiBV,GAAjB;AACpC,SAJD;AAKA3C,QAAAA,IAAI,CAACkC,KAAL,CAAWM,YAAX,CAAwB;AAACH,UAAAA,YAAY,EAAEiB;AAAf,SAAxB,EAAqDZ,OAArD,CAA6D,UAAAC,GAAG;AAAA,iBAAI,MAAI,CAACY,aAAL,CAAmBZ,GAAnB,CAAJ;AAAA,SAAhE;AACA,aAAKa,YAAL;AACA1D,QAAAA,GAAG,CAACoB,SAAJ,GAAgB,IAAI,KAAKV,YAAL,CAAkBQ,IAAtC;AACA,aAAKyC,OAAL,CAAajC,YAAb;AACA,aAAKkC,cAAL,CAAoBlC,YAApB,EAAkCI,CAAlC,EAAqCC,EAArC;AACH;;AAED/B,MAAAA,GAAG,CAAC6D,OAAJ;AACH;;;mCAGa;AACV,UAAIhB,GAAG,GAAG,KAAKpC,UAAL,CAAgB2B,KAAhB,CAAsBC,WAAtB,CAAkC;AAAEE,QAAAA,YAAY,EAAEuB;AAAhB,OAAlC,CAAV;;AACA,UAAGjB,GAAG,CAACkB,MAAJ,GAAa,CAAhB,EAAkB;AACd,YAAIC,MAAM,GAAG,IAAIvC,kBAAJ,CACToB,GAAG,CAACjB,QAAJ,CAAaD,CAAb,GAAiB,KAAKH,MAAL,CAAYG,CADpB,EAETkB,GAAG,CAACjB,QAAJ,CAAaC,CAAb,GAAiB,KAAKL,MAAL,CAAYK,CAFpB,CAAb;AAIA7B,QAAAA,GAAG,CAACiE,WAAJ,GAAkB,oBAAlB;AACAjE,QAAAA,GAAG,CAACkE,SAAJ,GAAgB,oBAAhB;AACAlE,QAAAA,GAAG,CAACmE,SAAJ;AACAnE,QAAAA,GAAG,CAACoE,GAAJ,CAAQJ,MAAM,CAACrC,CAAf,EAAkBqC,MAAM,CAACnC,CAAzB,EAA4BgB,GAAG,CAACkB,MAAhC,EAAwC,CAAxC,EAA2C,IAAIzD,IAAI,CAACC,EAApD;AACAP,QAAAA,GAAG,CAACqE,IAAJ,CAAS,MAAI,KAAK3D,YAAL,CAAkBQ,IAA/B,EAAqC,CAArC,EAAwC,CAAC,GAAD,GAAK,KAAKR,YAAL,CAAkBQ,IAA/D,EAAqE,MAAI,KAAKR,YAAL,CAAkBQ,IAA3F,EAAiG,IAAIZ,IAAI,CAACC,EAA1G;AACAP,QAAAA,GAAG,CAACsE,SAAJ;AACAtE,QAAAA,GAAG,CAACuE,IAAJ;AACH;AAEJ;;;4BAEO1B,G,EAAI;AACR;AACA7C,MAAAA,GAAG,CAACiE,WAAJ,GAAkB,OAAlB;AACAjE,MAAAA,GAAG,CAACkE,SAAJ,GAAgB,QAAhB;;AACA,WAAI,IAAIM,CAAC,GAAC,CAAV,EAAaA,CAAC,GAAG3B,GAAG,CAAC4B,WAArB,EAAkCD,CAAC,EAAnC,EAAsC;AAClCxE,QAAAA,GAAG,CAAC0E,QAAJ,CACI,CAAC,MAAMF,CAAC,GAAC,CAAT,IAAa,KAAK9D,YAAL,CAAkBQ,IADnC,EAEI,MAAK,KAAKR,YAAL,CAAkBQ,IAF3B,EAGI,IAAI,KAAKR,YAAL,CAAkBQ,IAH1B,EAII,IAAI,KAAKR,YAAL,CAAkBQ,IAJ1B;AAMAlB,QAAAA,GAAG,CAAC0E,QAAJ,CACI,CAAC,MAAMF,CAAC,GAAC,CAAT,IAAa,KAAK9D,YAAL,CAAkBQ,IADnC,EAEI,MAAK,KAAKR,YAAL,CAAkBQ,IAF3B,EAGI,IAAI,KAAKR,YAAL,CAAkBQ,IAH1B,EAII,KAAK,KAAKR,YAAL,CAAkBQ,IAJ3B;AAMH,OAjBO,CAkBR;;;AACAlB,MAAAA,GAAG,CAAC2E,WAAJ,GAAkB,OAAlB;AACA3E,MAAAA,GAAG,CAACkE,SAAJ,GAAgB,yBAAhB;AACAlE,MAAAA,GAAG,CAAC0E,QAAJ,CACI,KAAI,KAAKhE,YAAL,CAAkBQ,IAD1B,EAEI,MAAK,KAAKR,YAAL,CAAkBQ,IAF3B,EAGI2B,GAAG,CAAC+B,WAAJ,GAAmB,GAAnB,GAAyB,KAAKlE,YAAL,CAAkBQ,IAH/C,EAII,KAAK,KAAKR,YAAL,CAAkBQ,IAJ3B;AAMAlB,MAAAA,GAAG,CAACmE,SAAJ;AACAnE,MAAAA,GAAG,CAACqE,IAAJ,CACI,KAAI,KAAK3D,YAAL,CAAkBQ,IAD1B,EAEI,MAAK,KAAKR,YAAL,CAAkBQ,IAF3B,EAGI,MAAM,KAAKR,YAAL,CAAkBQ,IAH5B,EAII,KAAI,KAAKR,YAAL,CAAkBQ,IAJ1B;AAMAlB,MAAAA,GAAG,CAACsE,SAAJ;AACAtE,MAAAA,GAAG,CAAC6E,MAAJ,GAnCQ,CAoCR;;AACA7E,MAAAA,GAAG,CAAC2E,WAAJ,GAAkB,OAAlB;AACA3E,MAAAA,GAAG,CAACkE,SAAJ,GAAgB,qBAAhB;AACAlE,MAAAA,GAAG,CAAC0E,QAAJ,CAAa,KAAI,KAAKhE,YAAL,CAAkBQ,IAAnC,EAAyC,MAAK,KAAKR,YAAL,CAAkBQ,IAAhE,EAAsE2B,GAAG,CAACiC,MAAJ,IAAe,MAAMjC,GAAG,CAACkC,UAAzB,IAAsC,KAAKrE,YAAL,CAAkBQ,IAA9H,EAAoI,KAAI,KAAKR,YAAL,CAAkBQ,IAA1J;AACAlB,MAAAA,GAAG,CAACmE,SAAJ;AACAnE,MAAAA,GAAG,CAACqE,IAAJ,CAAS,KAAI,KAAK3D,YAAL,CAAkBQ,IAA/B,EAAqC,MAAK,KAAKR,YAAL,CAAkBQ,IAA5D,EAAkE,MAAM,KAAKR,YAAL,CAAkBQ,IAA1F,EAAgG,KAAI,KAAKR,YAAL,CAAkBQ,IAAtH;AACAlB,MAAAA,GAAG,CAACsE,SAAJ;AACAtE,MAAAA,GAAG,CAAC6E,MAAJ;AACH;;;mCAEcG,M,EAAQlD,C,EAAGC,E,EAAG;AACzB,UAAIkD,cAAc,GAAGtE,QAAQ,CAACuE,cAAT,CAAwB,OAAxB,CAArB;AACAD,MAAAA,cAAc,CAACE,SAAf,kCACaH,MAAM,CAACpD,QAAP,CAAgBD,CAD7B,sDAGaqD,MAAM,CAACpD,QAAP,CAAgBC,CAH7B,qDAKa,KAAKuD,KALlB,2DAOmB,KAAKC,WAAL,GAAmB,MAAnB,GAA4B,OAP/C,oDASYL,MAAM,CAACP,WATnB,4DAWoBO,MAAM,CAACP,WAAP,KAAuB,CAAC,CAAxB,GAA4B,MAA5B,GAAqC,OAXzD,iDAaS3C,CAbT,kDAeUC,EAfV;AAiBH;;;8BACSc,G,EAAI;AACV,aAAO,IAAIpB,kBAAJ,CACHoB,GAAG,CAACjB,QAAJ,CAAaD,CAAb,GAAiB,KAAKH,MAAL,CAAYG,CAA7B,GAAiCkB,GAAG,CAAC/B,KAAJ,GAAU,CADxC,EAEH+B,GAAG,CAACjB,QAAJ,CAAaC,CAAb,GAAiB,KAAKL,MAAL,CAAYK,CAA7B,GAAiCgB,GAAG,CAAC9B,MAAJ,GAAW,CAFzC,CAAP;AAIH;;;iDAE4BuE,I,EAAK;AAC9B,aAAQA,IAAI,GAAGhF,IAAI,CAACiF,KAAb,GAAsB,CAA7B;AACH;;;+BAEU1C,G,EAAK;AAEZ,UAAImB,MAAM,GAAG,KAAKwB,SAAL,CAAe3C,GAAf,CAAb;AACA,UAAIkB,MAAM,GAAG,KAAK0B,4BAAL,CAAkC5C,GAAG,CAAC/B,KAAtC,CAAb;AACA,UAAI4E,KAAK,GAAG7C,GAAG,CAACP,QAAJ,KAAiB,KAAK7B,UAAL,CAAgB6B,QAAjC,GAA4C,YAA5C,GAA2D,SAAvE;AACAtC,MAAAA,GAAG,CAACiE,WAAJ,GAAkByB,KAAlB;AACA1F,MAAAA,GAAG,CAAC2E,WAAJ,GAAkBe,KAAlB,CANY,CAOZ;;AACA,WAAKC,UAAL,CAAgB3B,MAAM,CAACrC,CAAvB,EAA0BqC,MAAM,CAACnC,CAAjC,EAAoCkC,MAApC,EARY,CASZ;;AACA/D,MAAAA,GAAG,CAACkE,SAAJ,GAAgB,OAAhB;AACAlE,MAAAA,GAAG,CAAC4F,IAAJ,GAAW,WAAX;AACA5F,MAAAA,GAAG,CAAC6F,QAAJ,CAAahD,GAAG,CAACiD,IAAjB,EAAuB9B,MAAM,CAACrC,CAAP,GAAYkB,GAAG,CAACiD,IAAJ,CAASC,MAAT,GAAgB,CAAnD,EAAuD/B,MAAM,CAACnC,CAAP,GAAW,CAAlE,EAZY,CAaZ;;AACA7B,MAAAA,GAAG,CAACgG,MAAJ,CAAWhC,MAAM,CAACrC,CAAlB,EAAoBqC,MAAM,CAACnC,CAA3B;AACA7B,MAAAA,GAAG,CAACiG,MAAJ,CAAWjC,MAAM,CAACrC,CAAP,GAAWoC,MAAM,GAAGzD,IAAI,CAAC4F,GAAL,CAASrD,GAAG,CAACsD,SAAb,CAA/B,EAAwDnC,MAAM,CAACnC,CAAP,GAAWkC,MAAM,GAAGzD,IAAI,CAAC8F,GAAL,CAASvD,GAAG,CAACsD,SAAb,CAA5E;AACAnG,MAAAA,GAAG,CAAC6E,MAAJ,GAhBY,CAiBZ;;AACA,UAAGhC,GAAG,CAAC4B,WAAJ,KAAoB,CAAC,CAAxB,EAA0B;AACtBzE,QAAAA,GAAG,CAACmE,SAAJ;AACAnE,QAAAA,GAAG,CAACoE,GAAJ,CAAQJ,MAAM,CAACrC,CAAf,EAAkBqC,MAAM,CAACnC,CAAzB,EAA4BkC,MAAM,GAAEA,MAAM,GAAC,CAA3C,EAA8C,EAA9C,EAAkD1D,GAAG,GAAG,EAAxD;AACAL,QAAAA,GAAG,CAAC6E,MAAJ;AACA7E,QAAAA,GAAG,CAACmE,SAAJ;AACAnE,QAAAA,GAAG,CAACoE,GAAJ,CAAQJ,MAAM,CAACrC,CAAf,EAAkBqC,MAAM,CAACnC,CAAzB,EAA4BkC,MAAM,GAAEA,MAAM,GAAC,CAA3C,EAA8C,IAAE1D,GAAF,GAAQ,EAAtD,EAA0D,IAAEA,GAAF,GAAQ,EAAlE;AACAL,QAAAA,GAAG,CAAC6E,MAAJ;AACA7E,QAAAA,GAAG,CAACmE,SAAJ;AACAnE,QAAAA,GAAG,CAACoE,GAAJ,CAAQJ,MAAM,CAACrC,CAAf,EAAkBqC,MAAM,CAACnC,CAAzB,EAA4BkC,MAAM,GAAEA,MAAM,GAAC,CAA3C,EAA8C,IAAE1D,GAAF,GAAQ,EAAtD,EAA0D,IAAEA,GAAF,GAAQ,EAAlE;AACAL,QAAAA,GAAG,CAAC6E,MAAJ;AACA7E,QAAAA,GAAG,CAACmE,SAAJ;AACAnE,QAAAA,GAAG,CAACoE,GAAJ,CAAQJ,MAAM,CAACrC,CAAf,EAAkBqC,MAAM,CAACnC,CAAzB,EAA4BkC,MAAM,GAAEA,MAAM,GAAC,CAA3C,EAA8C,IAAE1D,GAAF,GAAQ,EAAtD,EAA0D,IAAEA,GAAF,GAAQ,EAAlE;AACAL,QAAAA,GAAG,CAAC6E,MAAJ;AACH;;AAED,UAAGhC,GAAG,CAACwD,gBAAJ,KAAyB,CAA5B,EAA8B;AAC1BrG,QAAAA,GAAG,CAAC2E,WAAJ,GAAkB,OAAlB;AACA3E,QAAAA,GAAG,CAACiE,WAAJ,GAAkB,OAAlB;AACAjE,QAAAA,GAAG,CAACmE,SAAJ;AACAnE,QAAAA,GAAG,CAACoE,GAAJ,CAAQJ,MAAM,CAACrC,CAAf,EAAkBqC,MAAM,CAACnC,CAAzB,EAA4BkC,MAAM,GAAEA,MAAM,GAAC,CAA3C,EAA8C1D,GAAG,GAAC,EAAlD,EAAsD,IAAEA,GAAF,GAAQ,EAA9D;AACAL,QAAAA,GAAG,CAAC6E,MAAJ;AACA7E,QAAAA,GAAG,CAACmE,SAAJ;AACAnE,QAAAA,GAAG,CAACoE,GAAJ,CAAQJ,MAAM,CAACrC,CAAf,EAAkBqC,MAAM,CAACnC,CAAzB,EAA4BkC,MAAM,GAAEA,MAAM,GAAC,CAA3C,EAA8C,IAAE1D,GAAF,GAAQ,EAAtD,EAA0D,IAAEA,GAAF,GAAQ,EAAlE;AACAL,QAAAA,GAAG,CAAC6E,MAAJ;AACA7E,QAAAA,GAAG,CAACmE,SAAJ;AACAnE,QAAAA,GAAG,CAACoE,GAAJ,CAAQJ,MAAM,CAACrC,CAAf,EAAkBqC,MAAM,CAACnC,CAAzB,EAA4BkC,MAAM,GAAEA,MAAM,GAAC,CAA3C,EAA8C,IAAE1D,GAAF,GAAQ,EAAtD,EAA0D,IAAEA,GAAF,GAAQ,EAAlE;AACAL,QAAAA,GAAG,CAAC6E,MAAJ;AACA7E,QAAAA,GAAG,CAACmE,SAAJ;AACAnE,QAAAA,GAAG,CAACoE,GAAJ,CAAQJ,MAAM,CAACrC,CAAf,EAAkBqC,MAAM,CAACnC,CAAzB,EAA4BkC,MAAM,GAAEA,MAAM,GAAC,CAA3C,EAA8C,IAAE1D,GAAF,GAAQ,EAAtD,EAA0D,IAAEA,GAAF,GAAQ,EAAlE;AACAL,QAAAA,GAAG,CAAC6E,MAAJ;AACH;AACJ;;;+BAEUhC,G,EAAI;AACX7C,MAAAA,GAAG,CAACiE,WAAJ,GAAkB,QAAlB;AACAjE,MAAAA,GAAG,CAAC2E,WAAJ,GAAkB,QAAlB;AACA,UAAIX,MAAM,GAAG,KAAKwB,SAAL,CAAe3C,GAAf,CAAb;AACA7C,MAAAA,GAAG,CAACmE,SAAJ;AACAnE,MAAAA,GAAG,CAACoE,GAAJ,CAAQJ,MAAM,CAACrC,CAAf,EAAkBqC,MAAM,CAACnC,CAAzB,EAA4B,EAA5B,EAAgC,CAAhC,EAAmC,IAAEvB,IAAI,CAACC,EAA1C;AACAP,MAAAA,GAAG,CAAC6E,MAAJ;AACA7E,MAAAA,GAAG,CAACsE,SAAJ;AACH;;;gCAEWzB,G,EAAI;AACZ7C,MAAAA,GAAG,CAACiE,WAAJ,GAAkB,MAAlB;AACAjE,MAAAA,GAAG,CAAC2E,WAAJ,GAAkB,MAAlB;AACA,UAAIX,MAAM,GAAG,KAAKwB,SAAL,CAAe3C,GAAf,CAAb;AACA7C,MAAAA,GAAG,CAACmE,SAAJ;AACAnE,MAAAA,GAAG,CAACoE,GAAJ,CAAQJ,MAAM,CAACrC,CAAf,EAAkBqC,MAAM,CAACnC,CAAzB,EAA4B,EAA5B,EAAgC,CAAhC,EAAmC,IAAEvB,IAAI,CAACC,EAA1C;AACAP,MAAAA,GAAG,CAAC6E,MAAJ;AACA7E,MAAAA,GAAG,CAACsE,SAAJ;AACH;;;6BAEQzB,G,EAAI;AACT7C,MAAAA,GAAG,CAAC2E,WAAJ,GAAmB,OAAnB;AACA3E,MAAAA,GAAG,CAACiE,WAAJ,GAAkB,OAAlB;AACA,UAAID,MAAM,GAAG,KAAKwB,SAAL,CAAe3C,GAAf,CAAb;AACA,WAAKyD,OAAL,CAAatC,MAAM,CAACrC,CAApB,EAAuBqC,MAAM,CAACnC,CAA9B,EAAiCgB,GAAG,CAAC/B,KAArC,EAA4C+B,GAAG,CAAC9B,MAAhD;AACH;;;8BAES8B,G,EAAI;AACV7C,MAAAA,GAAG,CAACkE,SAAJ,GAAgB,oBAAhB;AACAlE,MAAAA,GAAG,CAACiE,WAAJ,GAAkB,KAAlB;AACA,UAAID,MAAM,GAAG,KAAKwB,SAAL,CAAe3C,GAAf,CAAb;AACAA,MAAAA,GAAG,CAAC0D,QAAJ,CAAa3D,OAAb,CAAqB,UAAA4D,EAAE,EAAI;AACvBxG,QAAAA,GAAG,CAACmE,SAAJ;AACAnE,QAAAA,GAAG,CAACoE,GAAJ,CAAQJ,MAAM,CAACrC,CAAP,GAAS,CAAT,GAAW6E,EAAE,CAAC,CAAD,CAArB,EAA0BxC,MAAM,CAACnC,CAAP,GAAS,CAAT,GAAW2E,EAAE,CAAC,CAAD,CAAvC,EAA4CA,EAAE,CAAC,CAAD,CAA9C,EAAmD,CAAnD,EAAsD,IAAElG,IAAI,CAACC,EAA7D;AACAP,QAAAA,GAAG,CAACsE,SAAJ;AACAtE,QAAAA,GAAG,CAACuE,IAAJ;AACH,OALD;AAMH;;;kCAEa1B,G,EAAK;AACf7C,MAAAA,GAAG,CAACkE,SAAJ,GAAgB,wBAAhB;AACAlE,MAAAA,GAAG,CAACiE,WAAJ,GAAkB,wBAAlB;AAA2C;AAC3C,UAAID,MAAM,GAAG,IAAIvC,kBAAJ,CACToB,GAAG,CAACjB,QAAJ,CAAaD,CAAb,GAAiB,KAAKH,MAAL,CAAYG,CADpB,EAETkB,GAAG,CAACjB,QAAJ,CAAaC,CAAb,GAAiB,KAAKL,MAAL,CAAYK,CAFpB,CAAb;AAIA7B,MAAAA,GAAG,CAACmE,SAAJ;AACAnE,MAAAA,GAAG,CAACoE,GAAJ,CAAQJ,MAAM,CAACrC,CAAf,EAAkBqC,MAAM,CAACnC,CAAzB,EAA4BgB,GAAG,CAACkB,MAAhC,EAAwC,CAAxC,EAA2C,IAAEzD,IAAI,CAACC,EAAlD;AACAP,MAAAA,GAAG,CAACsE,SAAJ;AACAtE,MAAAA,GAAG,CAACuE,IAAJ;AACH;;;+BAEU5C,C,EAAGE,C,EAAG4E,C,EAAK;AAClBzG,MAAAA,GAAG,CAACmE,SAAJ;AACAnE,MAAAA,GAAG,CAACoE,GAAJ,CAAQzC,CAAR,EAAWE,CAAX,EAAc4E,CAAd,EAAiB,CAAjB,EAAoB,IAAEnG,IAAI,CAACC,EAA3B;AACAP,MAAAA,GAAG,CAACsE,SAAJ;AACAtE,MAAAA,GAAG,CAAC6E,MAAJ;AACH;;;4BAEOlD,C,EAAGE,C,EAAG6E,C,EAAGC,C,EAAE;AACf3G,MAAAA,GAAG,CAACmE,SAAJ;AACAnE,MAAAA,GAAG,CAACqE,IAAJ,CAAS1C,CAAC,GAAI+E,CAAC,GAAC,CAAhB,EAAoB7E,CAAC,GAAI8E,CAAC,GAAC,CAA3B,EAA+BD,CAA/B,EAAkCC,CAAlC;AACA3G,MAAAA,GAAG,CAACsE,SAAJ;AACAtE,MAAAA,GAAG,CAAC6E,MAAJ;AACH;;;;EAvQuC+B,iB","sourcesContent":["import { Renderer, TwoVector } from 'lance-gg';\r\nimport Kombat from '../common/Kombat';\r\nimport Bullet from '../common/Bullet';\r\nimport Granade from '../common/Granade';\r\nimport Wall from '../common/Wall';\r\nimport Blood from '../common/Blood';\r\nimport Explosion2 from '../common/Explosion2';\r\nimport DeadZone from '../common/DeadZone';\r\n\r\nlet ctx = null;\r\nlet canvas = null;\r\nlet game = null;\r\nconst C_WIDTH = 800;\r\nconst C_HEIGHT = 600;\r\nconst QPI = Math.PI/4\r\nexport default class KombatRenderer extends Renderer {\r\n\r\n    constructor(gameEngine, clientEngine) {\r\n        super(gameEngine, clientEngine);\r\n        game = gameEngine;\r\n        canvas = document.createElement('canvas');\r\n        canvas.setAttribute('id', 'kc');\r\n        canvas.width = C_WIDTH;\r\n        canvas.height = C_HEIGHT;\r\n        document.body.appendChild(canvas);\r\n        clientEngine.zoom = 15;\r\n        ctx = canvas.getContext('2d');\r\n        ctx.lineWidth = 3 / clientEngine.zoom;\r\n        ctx.shadowOffsetX = 1;\r\n        ctx.shadowOffsetY = 1;\r\n        ctx.shadowBlur = 15; \r\n        this.offset = new TwoVector(0, 0);\r\n    }\r\n\r\n    setOffset(playerKombat){\r\n        this.offset.x = (C_WIDTH/2)/this.clientEngine.zoom - playerKombat.position.x - (playerKombat.width / 2);\r\n        this.offset.y = (C_HEIGHT/2)/this.clientEngine.zoom - playerKombat.position.y - (playerKombat.height / 2);\r\n    }\r\n\r\n    draw(t, dt) {\r\n        super.draw(t, dt);\r\n        ctx.clearRect(0, 0, C_WIDTH, C_HEIGHT);\r\n        ctx.save();\r\n        ctx.translate(0, 0);\r\n        ctx.scale(this.clientEngine.zoom, this.clientEngine.zoom);\r\n        ctx.lineWidth = 3 / this.clientEngine.zoom;\r\n        let playerKombat = this.gameEngine.world.queryObject({ playerId: this.gameEngine.playerId,  instanceType: Kombat });\r\n        if(playerKombat){\r\n            this.setOffset(playerKombat);\r\n            //draw blood stains first // layer 0\r\n            game.world.queryObjects({instanceType: Blood }).forEach(obj => this.drawBlood(obj));\r\n            game.world.queryObjects({instanceType: Wall }).forEach(obj => this.drawWall(obj));\r\n            game.world.forEachObject((id, obj) => {\r\n                if (obj instanceof Kombat) this.drawKombat(obj);\r\n                else if (obj instanceof Bullet) this.drawBullet(obj);\r\n                else if (obj instanceof Granade) this.drawGranade(obj);\r\n            });\r\n            game.world.queryObjects({instanceType: Explosion2 }).forEach(obj => this.drawExplosion(obj));\r\n            this.drawDeadZone();\r\n            ctx.lineWidth = 3 / this.clientEngine.zoom;\r\n            this.drawHUD(playerKombat);\r\n            this.updateDebugger(playerKombat, t, dt);\r\n        }\r\n       \r\n        ctx.restore();\r\n    }\r\n\r\n\r\n    drawDeadZone(){\r\n        let obj = this.gameEngine.world.queryObject({ instanceType: DeadZone });\r\n        if(obj.radius > 0){\r\n            let center = new TwoVector(\r\n                obj.position.x + this.offset.x,\r\n                obj.position.y + this.offset.y\r\n            );\r\n            ctx.shadowColor = \"rgba(100,0,255,.4)\";\r\n            ctx.fillStyle = \"rgba(100,0,255,.4)\";\r\n            ctx.beginPath();\r\n            ctx.arc(center.x, center.y, obj.radius, 0, 2 * Math.PI);\r\n            ctx.rect(800/this.clientEngine.zoom, 0, -800/this.clientEngine.zoom, 600/this.clientEngine.zoom, 2 * Math.PI);\r\n            ctx.closePath();\r\n            ctx.fill();\r\n        }\r\n       \r\n    }\r\n\r\n    drawHUD(obj){\r\n        //Bullets\r\n        ctx.shadowColor = 'white';\r\n        ctx.fillStyle = \"orange\";\r\n        for(let i=0; i < obj.ammo_loaded; i++){\r\n            ctx.fillRect(\r\n                (125 + i*6)/ this.clientEngine.zoom, \r\n                543/ this.clientEngine.zoom, \r\n                2 / this.clientEngine.zoom, \r\n                2 / this.clientEngine.zoom\r\n            );\r\n            ctx.fillRect(\r\n                (124 + i*6)/ this.clientEngine.zoom, \r\n                545/ this.clientEngine.zoom, \r\n                4 / this.clientEngine.zoom, \r\n                20 / this.clientEngine.zoom\r\n            );\r\n        }\r\n        //Throw Power\r\n        ctx.strokeStyle = \"white\";\r\n        ctx.fillStyle = \"rgba(255, 255, 255, .9)\";\r\n        ctx.fillRect(\r\n            20/ this.clientEngine.zoom, \r\n            544/ this.clientEngine.zoom, \r\n            obj.throw_power  * 100 / this.clientEngine.zoom, \r\n            18 / this.clientEngine.zoom\r\n        );\r\n        ctx.beginPath();\r\n        ctx.rect(\r\n            20/ this.clientEngine.zoom, \r\n            545/ this.clientEngine.zoom, \r\n            100 / this.clientEngine.zoom, \r\n            18/ this.clientEngine.zoom\r\n        );\r\n        ctx.closePath();\r\n        ctx.stroke();\r\n        //Life\r\n        ctx.strokeStyle = \"white\";\r\n        ctx.fillStyle = \"rgba(255, 0, 0, .5)\";\r\n        ctx.fillRect(20/ this.clientEngine.zoom, 570/ this.clientEngine.zoom, obj.health * ( 760 / obj.max_health)/ this.clientEngine.zoom, 18/ this.clientEngine.zoom);\r\n        ctx.beginPath();\r\n        ctx.rect(20/ this.clientEngine.zoom, 570/ this.clientEngine.zoom, 760 / this.clientEngine.zoom, 16/ this.clientEngine.zoom);\r\n        ctx.closePath();\r\n        ctx.stroke();\r\n    }\r\n\r\n    updateDebugger(player, t, dt){\r\n        let debugContainer = document.getElementById('debug');\r\n        debugContainer.innerHTML = `\r\n            Pos X: ${player.position.x}\r\n            <hr/> \r\n            Pos Y: ${player.position.y}\r\n            <hr/>\r\n            Angle: ${this.angle}\r\n            <hr/>\r\n            Is shooting: ${this.mouseIsDown ? \"true\" : \"false\"}\r\n            <hr/>\r\n            Ammo: ${player.ammo_loaded}\r\n            <hr/>\r\n            Is reloading: ${player.ammo_loaded === -1 ? \"true\" : \"false\"}\r\n            <hr/>\r\n            t: ${t}\r\n            <hr/>\r\n            dt: ${dt}\r\n        `\r\n    }\r\n    getCenter(obj){\r\n        return new TwoVector(\r\n            obj.position.x + this.offset.x + obj.width/2,\r\n            obj.position.y + this.offset.y + obj.height/2\r\n        )\r\n    }\r\n\r\n    getCircumscribedRadiusLength(edge){\r\n        return (edge * Math.SQRT2) / 2;\r\n    }\r\n\r\n    drawKombat(obj) {\r\n     \r\n        let center = this.getCenter(obj);\r\n        let radius = this.getCircumscribedRadiusLength(obj.width);\r\n        let color = obj.playerId === this.gameEngine.playerId ? \"dodgerblue\" : \"crimson\";\r\n        ctx.shadowColor = color;\r\n        ctx.strokeStyle = color;\r\n        //base circle\r\n        this.drawCircle(center.x, center.y, radius);\r\n        //kombat name\r\n        ctx.fillStyle = \"white\";\r\n        ctx.font = '1px Arial';\r\n        ctx.fillText(obj.name, center.x - (obj.name.length/4), center.y - 2);\r\n        //directional line\r\n        ctx.moveTo(center.x,center.y);\r\n        ctx.lineTo(center.x + radius * Math.cos(obj.direction), center.y + radius * Math.sin(obj.direction));\r\n        ctx.stroke();\r\n        //ammo reloading circle\r\n        if(obj.ammo_loaded === -1){\r\n            ctx.beginPath();\r\n            ctx.arc(center.x, center.y, radius+ radius/2, .1, QPI - .1);\r\n            ctx.stroke();\r\n            ctx.beginPath();\r\n            ctx.arc(center.x, center.y, radius+ radius/2, 2*QPI + .1, 3*QPI - .1);\r\n            ctx.stroke();\r\n            ctx.beginPath();\r\n            ctx.arc(center.x, center.y, radius+ radius/2, 4*QPI + .1, 5*QPI - .1);\r\n            ctx.stroke();\r\n            ctx.beginPath();\r\n            ctx.arc(center.x, center.y, radius+ radius/2, 6*QPI + .1, 7*QPI - .1);\r\n            ctx.stroke();\r\n        }\r\n\r\n        if(obj.throwing_granade === 1){\r\n            ctx.strokeStyle = \"white\";\r\n            ctx.shadowColor = \"white\";\r\n            ctx.beginPath();\r\n            ctx.arc(center.x, center.y, radius+ radius/2, QPI+.1, 2*QPI - .1);\r\n            ctx.stroke();\r\n            ctx.beginPath();\r\n            ctx.arc(center.x, center.y, radius+ radius/2, 3*QPI + .1, 4*QPI - .1);\r\n            ctx.stroke();\r\n            ctx.beginPath();\r\n            ctx.arc(center.x, center.y, radius+ radius/2, 5*QPI + .1, 6*QPI - .1);\r\n            ctx.stroke();\r\n            ctx.beginPath();\r\n            ctx.arc(center.x, center.y, radius+ radius/2, 7*QPI + .1, 8*QPI - .1);\r\n            ctx.stroke();\r\n        }\r\n    }\r\n\r\n    drawBullet(obj){\r\n        ctx.shadowColor = \"yellow\";\r\n        ctx.strokeStyle = \"yellow\";\r\n        let center = this.getCenter(obj);\r\n        ctx.beginPath();\r\n        ctx.arc(center.x, center.y, .5, 0, 2*Math.PI);\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n    }\r\n\r\n    drawGranade(obj){\r\n        ctx.shadowColor = \"lime\";\r\n        ctx.strokeStyle = \"lime\";\r\n        let center = this.getCenter(obj);\r\n        ctx.beginPath();\r\n        ctx.arc(center.x, center.y, .8, 0, 2*Math.PI);\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n    }\r\n\r\n    drawWall(obj){\r\n        ctx.strokeStyle =  \"white\";\r\n        ctx.shadowColor = \"white\";\r\n        let center = this.getCenter(obj);\r\n        this.drawBox(center.x, center.y, obj.width, obj.height);\r\n    }\r\n\r\n    drawBlood(obj){\r\n        ctx.fillStyle = \"rgba(200,100,0,.4)\"\r\n        ctx.shadowColor = \"red\";\r\n        let center = this.getCenter(obj);\r\n        obj.splatter.forEach(sp => {\r\n            ctx.beginPath();\r\n            ctx.arc(center.x+1+sp[0], center.y+1+sp[1], sp[2], 0, 2*Math.PI);\r\n            ctx.closePath();\r\n            ctx.fill();\r\n        });\r\n    }\r\n\r\n    drawExplosion(obj) {\r\n        ctx.fillStyle = \"rgba(200, 200, 10, .4)\";\r\n        ctx.shadowColor = \"rgba(200, 200, 10, .4)\";;\r\n        let center = new TwoVector(\r\n            obj.position.x + this.offset.x,\r\n            obj.position.y + this.offset.y\r\n        );\r\n        ctx.beginPath();\r\n        ctx.arc(center.x, center.y, obj.radius, 0, 2*Math.PI);\r\n        ctx.closePath();\r\n        ctx.fill();\r\n    }\r\n\r\n    drawCircle(x, y, r, ) {\r\n        ctx.beginPath();\r\n        ctx.arc(x, y, r, 0, 2*Math.PI);\r\n        ctx.closePath();\r\n        ctx.stroke();\r\n    }\r\n\r\n    drawBox(x, y, w, h){\r\n        ctx.beginPath();\r\n        ctx.rect(x - (w/2), y - (h/2), w, h);\r\n        ctx.closePath();\r\n        ctx.stroke();\r\n    }\r\n}\r\n"],"file":"KombatRenderer.js"}